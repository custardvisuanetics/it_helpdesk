<!doctype html>
<html>
<head><title>IT Help Desk</title></head>
<body>
    <h1>All Tickets</h1>
    <p>Welcome, <a href="{{ url_for('profile', username=g.user) }}">{{ g.user }}</a> | <a href="{{ url_for('logout') }}">Logout</a></p>
    <a href="{{ url_for('create_ticket') }}">Create New Ticket</a>
    <table border="1">
        <tr><th>ID</th><th>Title</th><th>Status</th><th>Priority</th><th>Actions</th></tr>
        {% for ticket in tickets %}
        <tr>
            <td>{{ ticket.id }}</td>
            <td>{{ ticket.title }}</td>
            <td>{{ ticket.status }}</td>
            <td>{{ ticket.priority }}</td>
            <td>
            <a href="{{ url_for('view_ticket', ticket_id=ticket.id) }}">View</a>
            <a href="{{ url_for('update_ticket', ticket_id=ticket.id) }}">Update</a>
            {% if g.role == 'admin' %}
            <form action="{{ url_for('delete_ticket', ticket_id=ticket.id) }}" method="post" style="display:inline;">
                <button type="submit" onclick="return confirm('Are you sure you want to delete this ticket?');">Delete</button>
            </form>
            {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
{% if g.role == 'admin' %}
<p><a href="{{ url_for('manage_users') }}">ðŸ”§ Manage Users</a></p>
{% endif %}
</body>
</html>
